# Vault AI Backend (FastAPI)
# Managed by Ansible â€” do not edit manually

[Unit]
Description=Vault AI Backend (FastAPI)
After=network.target docker.service

[Service]
Type=exec
User={{ vault_user }}
WorkingDirectory={{ vault_backend_dir }}
EnvironmentFile={{ vault_backend_config_dir }}/vault-backend.env
ExecStart={{ vault_backend_venv }}/bin/uvicorn app.main:app \
    --host 0.0.0.0 --port {{ vault_backend_port }} \
    --workers {{ vault_backend_workers }} \
    --log-level {{ vault_backend_log_level }}
Restart=always
RestartSec=5

# Security hardening
NoNewPrivileges=true
ProtectSystem=strict
ReadWritePaths={{ vault_backend_data_dir }} {{ vault_backend_log_dir }} {{ vault_backend_tls_dir }} {{ vault_backend_models_dir }} {{ vault_backend_quarantine_dir }} {{ vault_updates_dir }}

[Install]
WantedBy=multi-user.target
