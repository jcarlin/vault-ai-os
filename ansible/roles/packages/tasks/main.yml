---
# Packages Role - Essential Package Installation

- name: Update apt cache
  apt:
    update_cache: yes
    cache_valid_time: 3600

- name: Install essential system packages
  apt:
    name: "{{ essential_packages }}"
    state: present
    update_cache: yes

- name: Install development tools
  apt:
    name: "{{ development_packages }}"
    state: present

- name: Install monitoring tools
  apt:
    name: "{{ monitoring_packages }}"
    state: present

- name: Install network utilities
  apt:
    name: "{{ network_packages }}"
    state: present

- name: Install hardware diagnostic packages
  apt:
    name: "{{ hardware_packages }}"
    state: present

- name: Install disk management packages
  apt:
    name: "{{ disk_packages }}"
    state: present

- name: Install shell productivity packages
  apt:
    name: "{{ shell_packages }}"
    state: present

- name: Install archive packages
  apt:
    name: "{{ archive_packages }}"
    state: present

- name: Install network diagnostic packages
  apt:
    name: "{{ network_diagnostic_packages }}"
    state: present

- name: Install system utility packages
  apt:
    name: "{{ system_packages }}"
    state: present

- name: Clean up apt cache
  apt:
    autoclean: yes
    autoremove: yes

- name: Remove unnecessary packages
  apt:
    name:
      - snapd  # Remove snap if not needed
    state: absent
    purge: yes
  when: remove_snapd | bool
  ignore_errors: yes
