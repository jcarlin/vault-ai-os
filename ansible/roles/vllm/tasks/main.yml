---
# ansible/roles/vllm/tasks/main.yml

- name: Ensure Vault AI virtual environment exists
  command: python3.12 -m venv /opt/vault/venv --system-site-packages
  args:
    creates: /opt/vault/venv/bin/python

- name: Install vLLM
  pip:
    name: vllm
    virtualenv: /opt/vault/venv
  register: vllm_installed

- name: Verify vLLM installation
  shell: /opt/vault/venv/bin/python -c "from vllm import LLM; print('vLLM installed successfully')"
  register: vllm_check
  changed_when: false

- name: Display vLLM installation status
  debug:
    msg: "{{ vllm_check.stdout }}"
